# They Are Here â€” Civic Signal Aggregation Map

A delayed, aggregated map of when ICE-related issues become a topic of collective attention in Plainfield, NJ â€” grounded in public records and opt-in community signals.

**Not** a real-time alert system. **Not** a sighting tracker. A **memory map** of civic attention over time.

---

## ğŸš€ Quick Start

### 1. Install Dependencies

```bash
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# or
.venv\Scripts\activate  # Windows

pip install -r processing/requirements.txt
```

### 2. Run the Pipeline

```bash
# Full pipeline (scrape + process + export)
python run_pipeline.py --full

# Process existing data only
python run_pipeline.py

# Export only
python run_pipeline.py --export-only
```

### 3. Preview Locally

```bash
cd build
python -m http.server 8000
```

Then open: http://localhost:8000

### 4. Deploy to GitHub Pages

See [DEPLOYMENT.md](DEPLOYMENT.md) for detailed hosting instructions.

**Current Status:** v4.1 with 26 active data sources (RSS, NJ AG, Facebook)
- âš ï¸ Development mode active - See [STATUS.md](STATUS.md)

---

## ğŸ¯ Positioning & Differentiation

### Prior Art Context

Most prior systems in the geo-social and civic mapping space focus on either **real-time alerting** (e.g., Dataminr, Citizen) or **static visualization** of activity density (e.g., 311 dashboards, Snaptrends). Patents in this area primarily claim methods for location-based content filtering, proximity-driven interaction, or context-enhanced map interfaces, typically optimized for engagement, responsiveness, or operational dispatch. These systems rely on keyword matching, proximity graphs, kernel density estimation, or burst detection, and often operate at the individual or real-time event level.

### HEAT's White Space

HEAT occupies a distinct, under-patented space: **delayed, aggregated semantic mapping of collective civic attention**. Rather than tracking users or surfacing real-time alerts, HEAT intentionally buffers and clusters public records and opt-in signals to reveal *when and where issues become socially salient*. Its core innovation is not geolocation itself, but the combination of:

| Component | Purpose |
|-----------|--------|
| **Intentional input** | Opt-in signals, not scraped data |
| **Semantic clustering** | HDBSCAN + sentence embeddings |
| **Time decay** | Recent signals weighted higher |
| **Geographic aggregation** | ZIP-level, not individual |
| **Mandatory delay** | 24+ hour buffer before display |

This positions HEAT as a tool for **interpretation and understanding**, not surveillance or response â€” a category largely absent from existing patents and commercial platforms.

### Competitive Landscape

| System | Approach | HEAT Difference |
|--------|----------|----------------|
| Dataminr | Real-time event detection | We're intentionally delayed |
| Citizen/Life360 | Individual location tracking | We track ideas, not people |
| 311 Dashboards | Complaint density visualization | We extract semantic meaning |
| Snaptrends | Geo-tagged social media | We use curated public records |
| Hoodsquare | Static neighborhood profiling | We show temporal emergence |

---

## ğŸ“ Project Structure

```
heat/
â”œâ”€â”€ build/                      # Static files (deploy to S3)
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ app.js
â”‚   â”œâ”€â”€ styles.css
â”‚   â””â”€â”€ data/
â”‚       â”œâ”€â”€ clusters.json       # Generated by pipeline
â”‚       â”œâ”€â”€ timeline.json       # Generated by pipeline  
â”‚       â”œâ”€â”€ keywords.json       # Generated by NLP analysis
â”‚       â”œâ”€â”€ heatmap.json        # Generated by KDE
â”‚       â””â”€â”€ plainfield.geojson  # ZIP boundaries
â”‚
â”œâ”€â”€ processing/                 # Python data pipeline
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ ingest.py              # Normalize raw CSVs
â”‚   â”œâ”€â”€ cluster.py             # Semantic clustering (HDBSCAN)
â”‚   â”œâ”€â”€ nlp_analysis.py        # Keywords + burst detection + trends
â”‚   â”œâ”€â”€ heatmap.py             # Kernel density estimation
â”‚   â”œâ”€â”€ scraper.py             # Ethical RSS/news scraping
â”‚   â”œâ”€â”€ buffer.py              # Safety thresholds
â”‚   â””â”€â”€ export_static.py       # Export to JSON
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                   # Your input CSVs
â”‚   â”‚   â”œâ”€â”€ news.csv
â”‚   â”‚   â”œâ”€â”€ advocacy.csv
â”‚   â”‚   â””â”€â”€ council.csv
â”‚   â””â”€â”€ processed/             # Intermediate files
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ run_pipeline.bat       # Windows pipeline runner
â”‚   â”œâ”€â”€ run_pipeline.sh        # Mac/Linux pipeline runner
â”‚   â”œâ”€â”€ deploy_s3.bat          # Deploy to AWS S3
â”‚   â””â”€â”€ setup_s3.bat           # One-time S3 bucket setup
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ POSITIONING.md         # Patent landscape analysis
â”‚   â”œâ”€â”€ ALGORITHMS.md          # Algorithm documentation
â”‚   â””â”€â”€ MOBILE.md              # Mobile & text features guide
â”‚
â””â”€â”€ README.md
```

---

## ğŸ“± Mobile & Text Features

### iPhone PWA Support
Install HEAT as a standalone app:
1. Safari â†’ Share â†’ "Add to Home Screen"
2. Launch from home icon (fullscreen, no browser)

**Features:**
- âœ“ Safe area support (notch, home indicator)
- âœ“ True black OLED theme
- âœ“ 44px+ touch targets (iOS HIG)
- âœ“ Offline map tile caching

### 3D Satellite Mode
Toggle button in map header switches to:
- Esri World Imagery basemap
- Enhanced cluster visualization
- Pulse animations for high-attention areas

### Text Submission
**Web Form**: `submit.html` â€” Mobile-optimized signal submission
- ZIP selection dropdown
- Category picker (discussion/concern/rumor/confirmed)
- 10-500 character validation
- PII detection (blocks names, addresses, phones)

**SMS Handler** (Phase 2): Ready to deploy with Twilio
```python
# processing/sms_handler.py
handle_sms_webhook(phone_number, message_body)
# â†’ Auto-parses ZIP, validates, returns TwiML
```

### Text Exports
Generate all formats: `python processing/export_text.py`

1. **report.txt** â€” Plain text summary (email/SMS friendly)
2. **heat_data_YYYYMMDD.csv** â€” Full dataset
3. **heat_api.json** â€” Mobile app API format
4. **sms_digest.txt** â€” 160-char summary

**Example SMS Digest:**
```
HEAT: 3 clusters, increasing (+18%), top: community
```

### Event Tracking
Built-in analytics (no external services):
- Map interactions (zoom, pan, clicks)
- Cluster card views
- Submit button usage

Export via console:
```javascript
exportHeatEvents()  // Returns text log
```

ğŸ“– **Full Mobile Guide**: See [docs/MOBILE.md](docs/MOBILE.md)

---

## ğŸ“Š Data Format

### Input CSVs

All CSV files in `data/raw/` should have these columns:

| Column | Description | Example |
|--------|-------------|---------|
| `text` | The content/headline | "City council discusses..." |
| `zip` | ZIP code | "07060" |
| `date` | Date (YYYY-MM-DD) | "2025-01-10" |

### Output JSON

The pipeline generates:

- `clusters.json` â€” Semantic clusters with strength scores
- `timeline.json` â€” Weekly aggregation of all signals

---

## ğŸ›¡ï¸ Safety Thresholds

The buffer stage enforces these rules before any data appears publicly:

| Threshold | Value | Purpose |
|-----------|-------|---------|
| Minimum cluster size | 3 signals | No single-source clusters |
| Minimum sources | 2 different sources | Corroboration required |
| Time delay | 24 hours | No real-time information |
| Minimum strength | 1.5 | Filter out noise |

---

## â˜ï¸ Deploy to AWS S3 (Free)

### One-Time Setup

1. Install AWS CLI: https://aws.amazon.com/cli/
2. Configure credentials: `aws configure`
3. Edit `scripts/setup_s3.bat` â€” change `BUCKET_NAME`
4. Run: `scripts\setup_s3.bat`

### Deploy Updates

```batch
scripts\run_pipeline.bat
scripts\deploy_s3.bat
```

---

## ğŸ¯ What This Shows

âœ… **Aggregated** patterns of civic attention  
âœ… **Delayed** by at least 24 hours  
âœ… **Public sources** only (news, council minutes, advocacy reports)  
âœ… **ZIP-level** geographic resolution  

## ğŸš« What This Does NOT Show

âŒ Real-time locations or alerts  
âŒ Individual sightings or reports  
âŒ Vehicle descriptions or routes  
âŒ Any personally identifiable information  

---

## ï¿½ Algorithm Details

### Semantic Clustering

HEAT uses **HDBSCAN** (Hierarchical Density-Based Spatial Clustering) on **sentence-transformer embeddings** (`all-MiniLM-L6-v2`) to group records by meaning, not keywords.

```
Input texts â†’ Embeddings (384-dim) â†’ HDBSCAN â†’ Semantic clusters
```

### Attention Scoring

Cluster strength uses **exponential time decay**:

$$S = \sum_{i} e^{-\lambda \cdot \Delta t_i}$$

Where:
- $\lambda = \ln(2) / 72$ (72-hour half-life)
- $\Delta t_i$ = hours since record $i$

Recent signals contribute more than older ones, creating a "recency-weighted volume" score.

### Novelty Detection (Future)

$$N = 1 - \max(\text{cosine\_similarity}(c_{new}, C_{historical}))$$

Measures how different a new cluster is from past patterns. High novelty = emerging concern.

---

## ï¿½ğŸ“ License

Open source. Built for civic awareness, not surveillance.
